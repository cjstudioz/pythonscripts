import lib.hadoopUtilslib.hadoopUtils.FSCK_CMD = lib.hadoopUtils.FSCK_CMD.replace( '$HOSTNAME-0', '$HOSTNAME-1' )res = lib.hadoopUtils.fsck( '/phxfs2/data/FS2/hawk/work/default/simulation/20130531/STANDARD/4/1/0' )res2 = lib.hadoopUtils._flattenfsck(res)#'/phxfs2/data/FS2/hawk/work/default/simulation/20130531/STANDARD/4/1/0/IR_CURVE/IR.ANCHOR.GBP-6M'resByHost = [ x[ 'host' ] for x in res2 if x['blockOrder']==0 and 'IR.BASIS.CHF-DISCOUNT' in x['fileName'] ]resByFileName = [ x[ 'fileName' ] for x in res2 if x['blockOrder']==0 and x['host'] == 'svsrs00150']#write to csv filefrom csv import DictWriterdw = DictWriter( open('/apps/hpcops/temp/UATBaseFSCK2.csv', 'w' ), delimiter=',', fieldnames=('filename','count','hostcount' ), quotechar=r'"' )dw.writeheader()dw.writerows(res2)